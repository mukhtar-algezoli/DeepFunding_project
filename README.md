# Semantic Search with Adaptors Fine-tuning

## Training with Triplet Loss Function

### Dataset
#### Dataset before processing:
|     | question                                                  |   id |
|----:|:----------------------------------------------------------|-----:|
|  32 | ุงููุฑู ุฏู ูุงูู                                             |    2 |
|   9 | ุงุฒููู                                                     |    1 |
| 225 | ูุฑูุนูู ู ุงูุฏุฑูุงู                                          |    9 |
| 102 | ุงุณุนุงุฑ ุงูุนููุฉ ุงูููู                                        |    4 |
| 236 | ููู ุงุฑุงุถููู                                               |    9 |
| 104 | ุณุนุฑ ุงูุถููุงุฑ ูู                                            |    4 |
| 252 | ุงูุง ูู ุงูุณุนูุฏูู ุนุงูุฒ ุงุฑุณู ุงูุณูุฏุงู ุจุงูุจูู ููู              |   10 |
| 313 | ุงุชููู ูู ุงููู ุงูุงูุถูุงู ุงูู ูุฑูู ุงูุนูู ุงููุงุฆู ุฎุฑูุฌุฉ ูุญุงุณุจุฉ |   13 |
| 103 | ูู ูุณุงูู ูกููููุฌููู ูุตุฑ ูููู ุฌููู ุณูุฏุงูู                   |    4 |
| 311 | ุจุณุงู ูู ูุธุงุฆู ุงูุจูู ุฎุฑูุฌู ุนููู ุญุงุณูุจ                      |   13 |

#### Dataset after processing:
|     | Anchor                              | Positive                                                        | Negative                                                      |
|----:|:------------------------------------|:----------------------------------------------------------------|:--------------------------------------------------------------|
| 439 | ููุชุงุฒ๐ุดูุฑุง ูููู                    | ุดูุฑุง ุฌุฒููุง ูุตูุชูู ุงูุณ ูุงุชููุช ูุนุงููุชู ุจูู ูุณุฑ ุฌุฒุงูู ุงููู ุงูู ุฎูุฑ | ุนูุฏูู ูุธุงุฆู ูู ุณูุญุชู                                          |
|  62 | ูุงุฎู ุงูุชู ูุฑู                       | ุงูุชู ูุง ุจุชุฎุงููุง ุฑุจูุง ู ูุง ุดูู                                   | ุนุงูุฒ ุบุฑุฏ ุงุณุงูุฑ ุจุจูู                                           |
| 108 | ุชูููููู 6100ูุงุดุบุงู ุนูุฏูู ุชูููู ุชุงูู | ุงูุฑูู ูุบูู                                                      | ุณูุงู ุงูุง ุฏุงูุฑ ุงูุชุญ ุญุณุงุจ                                       |
| 197 | ุดูู ุงููุทููุจ ุนุดุงู ุงูุชุญ ุญุณุงุจ ุงุฌูุจู    | ุจุณุฃู ูู ูุชุญ ุญุณุฃุจ ุนูุฏูู ุจู ูู                                    | ุจุณุฃู ูู ุงูุชูููู                                               |
| 126 | ุฏุงูุฑ ุงุชููู ูุน ุฒูู ูู ุฎุฏูุฉ ุงูุนููุง    | ุงูุฑูู ูุบูู                                                      | ุจุณุฃู ูู ูุชุญ ุญุณุฃุจ ุนูุฏูู ุจู ูู                                  |
|   4 | ุงููุง                                | ุงุฒููู                                                           | ุฃุฑูุงููู ุงูุชู ุจุงููููุน ูุง ุชุนูู                                  |
|  69 | ูุงุฎู ูุง ุชุฌุถููุง ุดุบููู ุจุงุฎ            | ูุฑู ููุฑููู ูุงุฎ                                                  | ูู ุณุนุฑ ุงูููุฑู                                                 |
| 364 | ููู ุทุฑููุฉ ุงูุชุญููู ูู ุงูุณุนูุฏููุ      | ููู ูููู ุงุฑุณู ูุงุณุชูุจู ูู ุงูุณูุฏุงู ููุณุนูุฏูุฉ ูุงูุนูุณ                | ุงูุณุงุฏู ุงูุจูู ุงูุฃููู ุงูุณูุฏุงูู                                  |
| 466 | ุจุณุฃู ุงุฐุง ูุงู ุนูุฏูู ูุฑุต ุชูุธูู ุ      | ูู ุนูุฏูู ูุฑุต ุชุฏุฑูุจ ุชุฑูููุฌ                                       | ุฑูู ุงูุฌูุงู                                                    |
|  13 | ุงูู                                 | ุงูููู                                                           | ุณูุงู ุนูููู ูู ุทุฑููุฉ ุชุญููู ูู ุงูุณุนูุฏูู ุงูู ุจูู ุงูุงููู ุงูุณูุฏุงูู |

### Training and Results:
#### Training Parameters:
| Parameter           | Value |
|:--------------------|------:|
| Model               | MiniLM-L6-v2 |
| Batch Size          | 16 |
| Epochs              | 10 |
| Warmup Steps        | 100 |
| Model Save Path     | ./TripletLoss/models/sbert_model |

#### Results:
#### STS-B Test:
| Model           | Score |
|:--------------------|------:|
| MiniLM-L6-v2 | 0.8203247283076371 |
| ./TripletLoss/models/sbert_model | 0.819612290601182 |
#### Embedding Visualization:
![Embedding Visualization](figs/embs_vis.png)

#### Cosine Similarity Distance Averages:
![Cosine Similarity Distance Averages](figs/average_inter_and_intra_group_distances_vs_number_of_epochs.png)
#### Cosine Similarity Distance inter-group Plot:
![Cosine Similarity Distance inter-group Plot](figs/group_distance_group_distance.png)

#### Cosine Similarity Distance intra-group Plot:
![Cosine Similarity Distance intra-group Plot](figs/group_distance_total_distance.png)


